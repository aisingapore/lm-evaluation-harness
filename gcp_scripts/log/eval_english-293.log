bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
INFO: Model path=/mnt/fs-arf-01/cpt_checkpoints/hf_checkpoints/63-llama3-4node-replay40/ep0-ba1000
INFO: Model dtype=bfloat16
INFO: Ouput dir=/mnt/fs-arf-01/eval/results/eval_english
/usr/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)
INFO: Evaluating pretrained=/mnt/fs-arf-01/cpt_checkpoints/hf_checkpoints/63-llama3-4node-replay40/ep0-ba1000,parallelize=False,dtype=bfloat16 on tasks leaderboard_bbh,leaderboard_arc_challenge,leaderboard_gsm8k,aisg_internal_hellaswag,mmlu
The following values were not passed to `accelerate launch` and had defaults used instead:
	`--num_processes` was set to a value of `1`
	`--num_machines` was set to a value of `1`
	`--mixed_precision` was set to a value of `'no'`
	`--dynamo_backend` was set to a value of `'no'`
To avoid this warning pass in values for each of the problematic parameters or run `accelerate config`.
2024-07-11:10:23:32,344 INFO     [__main__.py:272] Verbosity set to INFO
2024-07-11:10:24:14,483 INFO     [__main__.py:369] Selected Tasks: ['aisg_internal_hellaswag', 'leaderboard_arc_challenge', 'leaderboard_bbh', 'leaderboard_gsm8k', 'mmlu']
2024-07-11:10:24:14,514 INFO     [evaluator.py:152] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234
2024-07-11:10:24:14,514 INFO     [evaluator.py:189] Initializing hf model, with arguments: {'pretrained': '/mnt/fs-arf-01/cpt_checkpoints/hf_checkpoints/63-llama3-4node-replay40/ep0-ba1000', 'parallelize': False, 'dtype': 'bfloat16'}
2024-07-11:10:24:15,373 INFO     [huggingface.py:170] Using device 'cuda'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.45s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:13<00:14,  7.47s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:17<00:05,  5.83s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  3.74s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:18<00:00,  4.54s/it]
Downloading metadata:   0%|          | 0.00/2.53k [00:00<?, ?B/s]Downloading metadata: 100%|██████████| 2.53k/2.53k [00:00<00:00, 9.00MB/s]
Downloading readme:   0%|          | 0.00/6.84k [00:00<?, ?B/s]Downloading readme: 100%|██████████| 6.84k/6.84k [00:00<00:00, 37.7MB/s]
2024-07-11:10:25:03,203 WARNING  [task.py:982] Task 'aisg_internal_hellaswag': num_fewshot > 0 but fewshot_split is None. using preconfigured rule.
Map:   0%|          | 0/39905 [00:00<?, ? examples/s]Map:   1%|▏         | 565/39905 [00:00<00:07, 5596.64 examples/s]Map:   3%|▎         | 1159/39905 [00:00<00:06, 5793.49 examples/s]Map:   5%|▌         | 2000/39905 [00:00<00:05, 6508.87 examples/s]Map:   7%|▋         | 2914/39905 [00:00<00:04, 7499.05 examples/s]Map:  10%|█         | 4000/39905 [00:00<00:05, 7083.27 examples/s]Map:  12%|█▏        | 4915/39905 [00:00<00:04, 7681.23 examples/s]Map:  15%|█▌        | 6000/39905 [00:00<00:04, 7265.59 examples/s]Map:  17%|█▋        | 6884/39905 [00:00<00:04, 7673.23 examples/s]Map:  20%|██        | 8000/39905 [00:01<00:04, 7286.60 examples/s]Map:  22%|██▏       | 8827/39905 [00:01<00:04, 7527.42 examples/s]Map:  25%|██▌       | 9986/39905 [00:01<00:03, 7592.54 examples/s]Map:  28%|██▊       | 11000/39905 [00:01<00:04, 6964.19 examples/s]Map:  30%|██▉       | 11904/39905 [00:01<00:03, 7441.89 examples/s]Map:  33%|███▎      | 13000/39905 [00:03<00:14, 1919.66 examples/s]Map:  34%|███▍      | 13723/39905 [00:03<00:11, 2297.50 examples/s]Map:  36%|███▋      | 14538/39905 [00:03<00:11, 2289.29 examples/s]Map:  38%|███▊      | 15061/39905 [00:03<00:09, 2554.38 examples/s]Map:  39%|███▉      | 15656/39905 [00:03<00:08, 2869.13 examples/s]Map:  41%|████      | 16435/39905 [00:04<00:09, 2542.56 examples/s]Map:  42%|████▏     | 16953/39905 [00:04<00:07, 2880.07 examples/s]Map:  44%|████▎     | 17430/39905 [00:04<00:09, 2370.29 examples/s]Map:  45%|████▌     | 18000/39905 [00:04<00:09, 2316.45 examples/s]Map:  46%|████▌     | 18432/39905 [00:05<00:10, 2090.63 examples/s]Map:  48%|████▊     | 19000/39905 [00:05<00:08, 2352.13 examples/s]Map:  49%|████▊     | 19440/39905 [00:05<00:09, 2250.72 examples/s]Map:  50%|█████     | 20000/39905 [00:05<00:07, 2499.61 examples/s]Map:  51%|█████     | 20338/39905 [00:05<00:09, 2040.91 examples/s]Map:  53%|█████▎    | 21000/39905 [00:06<00:07, 2430.87 examples/s]Map:  54%|█████▎    | 21428/39905 [00:06<00:08, 2221.97 examples/s]Map:  55%|█████▌    | 21989/39905 [00:06<00:06, 2763.87 examples/s]Map:  56%|█████▌    | 22429/39905 [00:06<00:08, 2167.54 examples/s]Map:  58%|█████▊    | 23000/39905 [00:06<00:06, 2415.46 examples/s]Map:  59%|█████▊    | 23423/39905 [00:07<00:07, 2236.66 examples/s]Map:  59%|█████▉    | 23695/39905 [00:07<00:07, 2104.79 examples/s]Map:  60%|██████    | 24000/39905 [00:07<00:07, 2197.78 examples/s]Map:  61%|██████    | 24423/39905 [00:07<00:07, 1967.28 examples/s]Map:  63%|██████▎   | 25000/39905 [00:07<00:06, 2313.04 examples/s]Map:  63%|██████▎   | 25334/39905 [00:08<00:08, 1811.22 examples/s]Map:  65%|██████▌   | 26000/39905 [00:08<00:06, 2225.15 examples/s]Map:  66%|██████▌   | 26331/39905 [00:08<00:07, 1860.95 examples/s]Map:  67%|██████▋   | 26608/39905 [00:08<00:06, 1948.59 examples/s]Map:  68%|██████▊   | 27000/39905 [00:09<00:06, 2044.34 examples/s]Map:  69%|██████▊   | 27426/39905 [00:09<00:06, 2056.57 examples/s]Map:  70%|███████   | 28000/39905 [00:09<00:04, 2484.71 examples/s]Map:  71%|███████   | 28428/39905 [00:09<00:05, 2231.80 examples/s]Map:  73%|███████▎  | 29000/39905 [00:09<00:04, 2442.68 examples/s]Map:  74%|███████▎  | 29426/39905 [00:10<00:04, 2345.87 examples/s]Map:  75%|███████▌  | 30000/39905 [00:10<00:03, 2559.37 examples/s]Map:  76%|███████▌  | 30426/39905 [00:10<00:04, 2168.53 examples/s]Map:  78%|███████▊  | 31000/39905 [00:10<00:04, 2022.86 examples/s]Map:  79%|███████▉  | 31613/39905 [00:10<00:03, 2571.35 examples/s]Map:  80%|████████  | 32000/39905 [00:11<00:02, 2655.88 examples/s]Map:  81%|████████▏ | 32433/39905 [00:11<00:03, 2072.98 examples/s]Map:  82%|████████▏ | 32802/39905 [00:11<00:03, 2264.20 examples/s]Map:  83%|████████▎ | 33093/39905 [00:11<00:04, 1680.41 examples/s]Map:  84%|████████▎ | 33334/39905 [00:11<00:03, 1712.38 examples/s]Map:  85%|████████▌ | 34000/39905 [00:12<00:02, 2116.89 examples/s]Map:  86%|████████▌ | 34392/39905 [00:12<00:02, 2030.39 examples/s]Map:  87%|████████▋ | 34915/39905 [00:12<00:01, 2569.37 examples/s]Map:  89%|████████▉ | 35426/39905 [00:12<00:02, 2025.80 examples/s]Map:  90%|█████████ | 35989/39905 [00:12<00:01, 2583.41 examples/s]Map:  91%|█████████▏| 36417/39905 [00:13<00:01, 1941.22 examples/s]Map:  92%|█████████▏| 36874/39905 [00:13<00:01, 2177.97 examples/s]Map:  94%|█████████▍| 37425/39905 [00:13<00:01, 1938.71 examples/s]Map:  95%|█████████▍| 37880/39905 [00:13<00:00, 2194.39 examples/s]Map:  96%|█████████▋| 38425/39905 [00:14<00:00, 1856.38 examples/s]Map:  98%|█████████▊| 39000/39905 [00:14<00:00, 2180.15 examples/s]Map:  99%|█████████▉| 39420/39905 [00:14<00:00, 1947.28 examples/s]Map: 100%|█████████▉| 39901/39905 [00:14<00:00, 2112.52 examples/s]Map: 100%|██████████| 39905/39905 [00:20<00:00, 1989.06 examples/s]
2024-07-11:10:25:23,270 WARNING  [task.py:982] Task 'aisg_internal_hellaswag': num_fewshot > 0 but fewshot_split is None. using preconfigured rule.
Map:   0%|          | 0/10042 [00:00<?, ? examples/s]Map:   7%|▋         | 659/10042 [00:00<00:01, 6529.76 examples/s]Map:  14%|█▍        | 1424/10042 [00:00<00:01, 6738.51 examples/s]Map:  21%|██        | 2125/10042 [00:00<00:01, 6854.87 examples/s]Map:  30%|██▉       | 3000/10042 [00:00<00:00, 7187.77 examples/s]Map:  38%|███▊      | 3821/10042 [00:00<00:00, 7534.70 examples/s]Map:  48%|████▊     | 4846/10042 [00:00<00:00, 6991.66 examples/s]Map:  58%|█████▊    | 5851/10042 [00:00<00:00, 6807.34 examples/s]Map:  68%|██████▊   | 6840/10042 [00:01<00:00, 4546.37 examples/s]Map:  74%|███████▍  | 7472/10042 [00:01<00:00, 4865.51 examples/s]Map:  81%|████████  | 8119/10042 [00:01<00:00, 5193.31 examples/s]Map:  89%|████████▉ | 8973/10042 [00:01<00:00, 5949.57 examples/s]Map: 100%|█████████▉| 10000/10042 [00:01<00:00, 5974.63 examples/s]Map: 100%|██████████| 10042/10042 [00:02<00:00, 4623.54 examples/s]
2024-07-11:10:25:47,866 WARNING  [task.py:982] Task 'leaderboard_arc_challenge': num_fewshot > 0 but fewshot_split is None. using preconfigured rule.
2024-07-11:10:25:47,866 WARNING  [task.py:982] Task 'leaderboard_arc_challenge': num_fewshot > 0 but fewshot_split is None. using preconfigured rule.
Downloading data:   0%|          | 0.00/10.7k [00:00<?, ?B/s]Downloading data: 100%|██████████| 10.7k/10.7k [00:00<00:00, 21.0kB/s]Downloading data: 100%|██████████| 10.7k/10.7k [00:00<00:00, 21.0kB/s]
Generating test split:   0%|          | 0/146 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 146/146 [00:00<00:00, 10696.20 examples/s]
Downloading data:   0%|          | 0.00/16.4k [00:00<?, ?B/s]Downloading data: 100%|██████████| 16.4k/16.4k [00:00<00:00, 34.4kB/s]Downloading data: 100%|██████████| 16.4k/16.4k [00:00<00:00, 34.4kB/s]
Generating test split:   0%|          | 0/178 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 178/178 [00:00<00:00, 928.38 examples/s]Generating test split: 100%|██████████| 178/178 [00:00<00:00, 659.20 examples/s]
Downloading data:   0%|          | 0.00/15.6k [00:00<?, ?B/s]Downloading data: 100%|██████████| 15.6k/15.6k [00:00<00:00, 20.2kB/s]Downloading data: 100%|██████████| 15.6k/15.6k [00:00<00:00, 20.2kB/s]
Generating test split:   0%|          | 0/250 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 250/250 [00:00<00:00, 22466.92 examples/s]
Downloading data:   0%|          | 0.00/8.16k [00:00<?, ?B/s]Downloading data: 100%|██████████| 8.16k/8.16k [00:00<00:00, 15.8kB/s]Downloading data: 100%|██████████| 8.16k/8.16k [00:00<00:00, 15.8kB/s]
Generating test split:   0%|          | 0/250 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 250/250 [00:00<00:00, 12954.34 examples/s]
Downloading builder script:   0%|          | 0.00/5.86k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 5.86k/5.86k [00:00<00:00, 36.3MB/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 100 examples [00:00, 1407.56 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 11 examples [00:00, 989.69 examples/s]
Generating dev split: 0 examples [00:00, ? examples/s]Generating dev split: 5 examples [00:00, 71.85 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 100 examples [00:00, 1383.71 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 9 examples [00:00, 846.57 examples/s]
Generating dev split: 0 examples [00:00, ? examples/s]Generating dev split: 5 examples [00:00, 67.27 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 216 examples [00:00, 2707.15 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 23 examples [00:00, 1761.51 examples/s]
Generating dev split: 0 examples [00:00, ? examples/s]Generating dev split: 5 examples [00:00, 71.74 examples/s]
Generating test split: 0 examples [00:00, ? examples/s]Generating test split: 235 examples [00:00, 3106.75 examples/s]
Generating validation split: 0 examples [00:00, ? examples/s]Generating validation split: 26 examples [00:00, 2637.54 examples/s]
Generating dev split: 0 examples [00:00, ? examples/s]Generating dev split: 5 examples [00:00, 71.82 examples/s]
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 293 ON localhost CANCELLED AT 2024-07-11T10:29:41 ***
slurmstepd: error: *** STEP 293.0 ON localhost CANCELLED AT 2024-07-11T10:29:41 ***
